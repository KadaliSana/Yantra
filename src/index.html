<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CrowdSentinel â€” Live Risk Monitor</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Barlow+Condensed:wght@300;400;600;700;900&family=Barlow:wght@300;400&display=swap" rel="stylesheet"/>
  
  <link rel="stylesheet" href="style.css">
  
  <style>
     /* Additional override to hide video when stopped */
     #videoFeed { opacity: 0.2; transition: opacity 0.5s; }
     #videoFeed.active { opacity: 1; }
     .btn-cyber {
        background: rgba(0, 255, 255, 0.1);
        border: 1px solid #0ff;
        color: #0ff;
        padding: 10px 20px;
        font-family: 'Share Tech Mono', monospace;
        cursor: pointer;
        text-transform: uppercase;
        transition: all 0.3s;
        margin-right: 10px;
     }
     .btn-cyber:hover { background: #0ff; color: #000; box-shadow: 0 0 15px #0ff; }
     .btn-cyber.danger { border-color: #f00; color: #f00; background: rgba(255,0,0,0.1); }
     .btn-cyber.danger:hover { background: #f00; color: #000; box-shadow: 0 0 15px #f00; }
  </style>
</head>
<body>

  <div class="scanlines" aria-hidden="true"></div>
  <div class="grain" aria-hidden="true"></div>

  <header class="header">
    <div class="header-left">
      <div class="logo-mark">
        <span class="logo-dot"></span><span class="logo-dot"></span><span class="logo-dot"></span>
      </div>
      <div>
        <h1 class="logo-text">CROWD<span>SENTINEL</span></h1>
        <p class="logo-sub">AI-IoT Stampede Risk Prediction System</p>
      </div>
    </div>
    <div class="header-right">
      <div class="live-badge" id="liveBadge" style="opacity: 0.3;">
        <span class="pulse-ring"></span>
        <span class="live-text">OFFLINE</span>
      </div>
      <div class="system-time" id="systemTime">--:--:--</div>
    </div>
  </header>

  <main class="main-grid">

    <section class="panel panel--feed">
      <div class="panel-label">
        <span class="label-icon">â—ˆ</span> LIVE FEED â€” AMB82 MINI / KVS
      </div>
      <div class="feed-wrapper">
        <img id="videoFeed" src="" alt="System Standby" />
        
        <div class="feed-overlay">
          <div class="corner tl"></div><div class="corner tr"></div>
          <div class="corner bl"></div><div class="corner br"></div>
        </div>
        <div class="feed-status">
          <span class="feed-status__dot" id="feedDot"></span>
          <span id="feedStatusText">SYSTEM STANDBY</span>
        </div>
      </div>
    </section>

    <aside class="sidebar">

      <div class="card card--count">
        <div class="card__label">DETECTED PERSONS</div>
        <div class="count-display">
          <span class="count-number" id="personCount">0</span>
          <span class="count-unit">PPL</span>
        </div>
        <div class="count-bar-wrapper">
          <div class="count-bar" id="countBar"></div>
        </div>
        <div class="count-meta">
          <span>Threshold: <b id="threshVal">50</b></span>
          <span>Peak: <b id="peakVal">0</b></span>
        </div>
      </div>

      <div class="card card--risk">
        <div class="card__label">STAMPEDE RISK</div>
        <div class="risk-ring-wrapper">
          <svg class="risk-ring" viewBox="0 0 120 120">
            <circle class="ring-bg" cx="60" cy="60" r="50" />
            <circle class="ring-fill" id="riskRingFill" cx="60" cy="60" r="50" stroke-dasharray="314" stroke-dashoffset="314" />
          </svg>
          <div class="risk-center">
            <div class="risk-pct" id="riskPct">0%</div>
            <div class="risk-label" id="riskLabel">LOW</div>
          </div>
        </div>
        <div class="risk-zones">
          <span class="zone zone--low">LOW</span>
          <span class="zone zone--mod">MOD</span>
          <span class="zone zone--high">HIGH</span>
          <span class="zone zone--critical">CRIT</span>
        </div>
      </div>
      
      <div class="controls" style="margin: 20px 0; text-align: center;">
        <input type="file" id="imgUpload" accept="image/*" style="display: none" />
        
        <button id="btnStreamToggle" class="btn-cyber" onclick="toggleSystem()">
          INITIALIZE SYSTEM
        </button>

        <button class="btn-cyber" onclick="document.getElementById('imgUpload').click()">
          ðŸ“‚ UPLOAD IMG
        </button>
      </div>

      <div class="card card--density">
        <div class="card__label">CROWD DENSITY</div>
        <div class="density-gauge">
          <div class="density-col" id="dc0"></div><div class="density-col" id="dc1"></div>
          <div class="density-col" id="dc2"></div><div class="density-col" id="dc3"></div>
          <div class="density-col" id="dc4"></div><div class="density-col" id="dc5"></div>
          <div class="density-col" id="dc6"></div><div class="density-col" id="dc7"></div>
        </div>
        <div class="density-labels">
          <span>SPARSE</span><span>DENSE</span><span>CRITICAL</span>
        </div>
      </div>

    </aside>

    <div class="alert-strip" id="alertStrip">
      <span class="alert-icon" id="alertIcon">âš </span>
      <span class="alert-msg" id="alertMsg">SYSTEM STANDBY</span>
    </div>

    <section class="panel panel--chart">
      <div class="panel-label"><span class="label-icon">â—ˆ</span> CROWD COUNT TIMELINE</div>
      <div class="chart-wrapper">
        <canvas id="timelineChart"></canvas>
        <div class="chart-grid" aria-hidden="true"></div>
      </div>
    </section>

    <section class="stats-row">
      <div class="stat-card">
        <div class="stat-val" id="statAvg">â€”</div><div class="stat-key">AVG COUNT</div>
      </div>
      <div class="stat-card">
        <div class="stat-val" id="statMax">â€”</div><div class="stat-key">SESSION PEAK</div>
      </div>
      <div class="stat-card">
        <div class="stat-val" id="statAlerts">0</div><div class="stat-key">ALERTS FIRED</div>
      </div>
      <div class="stat-card">
        <div class="stat-val" id="statUptime">00:00</div><div class="stat-key">UPTIME</div>
      </div>
    </section>

  </main>

  <div class="critical-overlay" id="criticalOverlay">
    <div class="critical-box">
      <div class="critical-icon">âš </div>
      <div class="critical-title">CRITICAL RISK DETECTED</div>
      <div class="critical-sub">Crowd density exceeds safe threshold. Immediate action required.</div>
      <button class="critical-dismiss" onclick="dismissCritical()">ACKNOWLEDGE</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
  
  <script src="main.js"></script>
</body>
</html>